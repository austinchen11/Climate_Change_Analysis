
```{r}
temp_change = read.csv('Annual_Surface_Temperature_Change.csv', stringsAsFactors = TRUE)
sea_level_change = read.csv("Change_in_Mean_Sea_Levels.csv", stringsAsFactors = TRUE)
world_co2 = read.csv('Atmospheric_CO%E2%82%82_Concentrations.csv', stringsAsFactors = TRUE)
```

```{r}
table(sea_level_change$Measure)
```

```{r}
# Missing Value analysis for temperature change
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
library(forcats)

temp_change = temp_change[, -c(3, 4, 5, 6 ,7 ,8 ,9, 10)]
temp_change_numeric = temp_change[, -c(1, 2)]

colSums(is.na(temp_change_numeric))
```

```{r}

library(mi)
x = missing_data.frame(temp_change_numeric)
image(x)
```


```{r fig.width= 10, fig.height=5}

tidytemp <- temp_change_numeric %>% 
    rownames_to_column("id") %>% 
    gather(key, value, -id) %>% 
    mutate(missing = ifelse(is.na(value), "yes", "no"))

ggplot(tidytemp, aes(x = key, y = fct_rev(id), fill = missing)) +
  geom_tile(color = "white") + 
  ylab('') + 
  scale_fill_viridis_d() + # discrete scale
  theme_bw()
```

```{r fig.width= 10}
library(redav)  
plot_missing(temp_change_numeric, percent = FALSE)
```

```{r fig.width= 10, fig.height=5}

temp_change_removed = na.omit(temp_change)
 
library(reshape2)
temp_change = temp_change[, -c(1)]

subset(temp_change_removed, Country %in% c('United States', 'India', 'Japan', 'Germany', 'Indonesia', 'France', 'Brazil', 'United Kingdom', 'Italy', 'Mexico', 'China, P.R.: Mainland'))

df_temp <- melt(temp_change_removed_top[, -c(1)], id.vars=c("Country"),value.name="Value", variable.name="Year")

ggplot(data=subset(df_temp, Country %in% c('United States', 'India', 'Japan', 'Germany', 'Indonesia', 'France', 'Brazil', 'United Kingdom', 'Italy', 'Mexico', 'China, P.R.: Mainland')), aes(x=Year, y=Value, group = Country, colour = Country)) +
  geom_line() +
  geom_point()


```

```{r}
temp_change_removed['average'] = rowMeans(temp_change_removed[, -c(1, 2)])
temp_ordered_average = temp_change_removed[order(temp_change_removed$average, decreasing = TRUE),]



gdp = gdp[gdp$Item == "Gross Domestic Product (GDP)",]
```


```{r fig.width=10}
world_co2 = world_co2[, -c(1, 3, 4, 5, 7, 8, 9, 10)]
world_co2 = world_co2[world_co2$Unit == "Parts Per Million", ]

ggplot(data = world_co2, aes(x = Date, y = Value)) +
  geom_point() +

```

```{r fig.width= 10, fig.height= 10}
sea_level_change_region = sea_level_change[, -c(1:10)]

ggplot(data = sea_level_change, aes(x = Date, y = Value, group = Measure, color = Measure)) + 
  geom_line()

ggplot(data = sea_level_change, aes(x = Date, y =Value)) +
  geom_line() +
  facet_wrap(~Measure)
```

```{r}
sea_level_change_region$Date = substring(sea_level_change_region$Date, 2)
sea_level_change_region$Date = gsub("/", "-", sea_level_change_region$Date)
sea_level_change_region$Date = as.Date(sea_level_change_region$Date, format = "%m-%d-%Y")

sl_group = sea_level_change_region %>%
  group_by(Date) %>%
  summarize(mean_change = mean(Value))

ggplot(data = sl_group, aes(x = Date, y = mean_change)) +
  geom_line()
```




